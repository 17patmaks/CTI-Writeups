title: Suspicious ClickFix PowerShell Command Execution
id: a7f3e2c1-9d4e-4a2b-8f1c-3e5d7a9b2c1f
status: experimental
description: Detects PowerShell commands that download and execute payloads via ClickFix technique
references:
    - https://www.recordedfuture.com/research/graybravos-castleloader-activity-clusters-target-multiple-industries
author: Recorded Future Security Team
date: 2025-12-21
tags:
    - attack.execution
    - attack.t1059.001
    - attack.t1204.002
logsource:
    category: process_creation
    product: windows
detection:
    selection_powershell:
        Image|endswith: '\powershell.exe'
        CommandLine|contains:
            - 'iwr '
            - 'Invoke-WebRequest'
    selection_download:
        CommandLine|contains: '-OutFile'
    selection_execution:
        CommandLine|contains:
            - 'pythonw.exe'
            - 'Expand-Archive'
            - 'msg *'
    selection_hidden:
        CommandLine|contains: '-WindowStyle Hidden'
    condition: selection_powershell and selection_download and (selection_execution or selection_hidden)
falsepositives:
    - Legitimate software deployment scripts
level: high
